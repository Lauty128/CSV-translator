import{table as e,inherited_table as t,count_rows_columns as a,count_rows_columns_of_simple_array as l}from"./table.js";import{parseIntervalData as n}from"./intervals.js";let Table;if("/table"==window.location.pathname){if(localStorage.getItem("table_data")){let r=JSON.parse(localStorage.getItem("table_data")),{rows:i,columns:s}=a(r);(Table=new t(i,s)).printData(r),localStorage.removeItem("table_data")}else Table=new e;if(localStorage.getItem("interval_data")){let o=n(JSON.parse(localStorage.getItem("interval_data")));localStorage.removeItem("interval_data"),Table.table.insertAdjacentElement("afterend",o)}}if(document.querySelector(".TableContainer").addEventListener("click",async e=>{let{target:t}=e;switch(t.getAttribute("id")){case"newRow_button":Table.newRow(e);break;case"newColumn_button":Table.newColumn(e);break;case"cancelTable":Table.reset();break;case"createIntervalButton":submitInterval();break;case"cancelIntervalButton":localStorage.getItem("interval_table")&&(localStorage.removeItem("interval_table"),window.location.href="/intervals");break;case"comeBackButton":window.location.href="/"}}),"/intervals"==window.location.pathname){if(localStorage.getItem("interval_table")){let b=JSON.parse(localStorage.getItem("interval_table")),{rows:m,columns:c}=l(b);(Table=new t).printData(b)}else Table=new e;document.querySelector(".Table").addEventListener("submit",e=>e.preventDefault())}async function submitInterval(){let e=document.getElementById("quantity-input").value,t=document.getElementById("intervalType-input").value;if(e<=0)return Error("El valor debe ser mayor a 0(cero)");let a=new FormData(document.getElementById("Table")),l=new URLSearchParams(a),n=await fetch(`/api/intervals?type=${t}&quantity=${e}`,{method:"post",body:l}).then(e=>e.json());200==n.status&&(delete n.status,localStorage.setItem("table_data",JSON.stringify(n.table)),localStorage.setItem("interval_table",JSON.stringify(n.numbers)),delete n.table,localStorage.setItem("interval_data",JSON.stringify(n)),window.location.href="/table")}"/submit"==window.location.pathname&&document.getElementById("input_file").addEventListener("change",async e=>{e.preventDefault();let t=new FormData(document.getElementById("Table")),a=await fetch("/api/submit",{method:"post",body:t}).then(e=>e.json());if(200===a.status)localStorage.setItem("table_data",JSON.stringify(a.data)),window.location.href="/table";else throw Error("Ocurrio un error al subir el archivo")});